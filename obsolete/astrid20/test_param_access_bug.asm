; Generated by Astrid 2.0 Simple Stack-Centric Compiler
; Architecture: Nova-16 with absolute addressing
; Optimized for stack-first operations with built-in support

add_two_numbers:
    PUSH FP                       ; Save caller's frame pointer
    MOV FP, SP                    ; Set up new frame pointer
    MOV P7, FP                    ; Copy FP to temp register
    ADD P7, 4               ; Add parameter offset
    MOV R0, [P7]        ; Load parameter v0
    MOV P0, R0             ; Convert to 16-bit
    MOV P7, FP                    ; Copy FP to temp register
    ADD P7, 6               ; Add parameter offset
    MOV R1, [P7]        ; Load parameter v1
    MOV P1, R1             ; Convert to 16-bit
    ADD P0, P1             ; ADD v1
    MOV [0xF000], P0     ; Store 16-bit result temporarily
    MOV R0, [0xF000]     ; Load back low byte
    MOV [0xFFE0], R0     ; Store to v2
    MOV R0, [0xFFE0]     ; Load v2

main:
    MOV R0, 10             ; Load constant 10
    MOV [0xFFE0], R0     ; Store to v3
    MOV R0, 20             ; Load constant 20
    MOV [0xFFDE], R0     ; Store to v4
    MOV R0, [0xFFDE]     ; Load v4
    PUSH R0                       ; Push parameter v4
    MOV R0, [0xFFE0]     ; Load v3
    PUSH R0                       ; Push parameter v3
    CALL add_two_numbers               ; Call function add_two_numbers
    ADD SP, 4         ; Clean up 2 parameters
    MOV [0xFFDC], R0     ; Store to v5
    HLT                           ; Halt system
